<odoo>
    <!--
        This is the main template for the patient card report.
        It uses a basic Odoo layout and iterates through the selected patient records
        to display them all on a single page.
    -->
    <template id="report_patient_card_template">
        <t t-call="web.html_container">
            <t t-call="web.basic_layout">
                <div class="page">
                    <!--
                        The t-foreach loop is placed inside the 'page' div.
                        This ensures all records are printed on the same page.
                        لو عايز كل نسخة تظهر لوحدها اجط اللوب برة ال basic layout
                    -->
                    <t t-foreach="docs" t-as="o">
                        <!--
                            This container div holds a single patient card.
                            'page-break-inside: avoid' attempts to keep the card from splitting across pages if printed.
                            A bottom border is added to separate patient cards visually.
                        -->
                        <div class="patient-card"
                             style="page-break-inside: avoid !important; padding-bottom: 20px; border-bottom: 1px solid #ccc; margin-bottom: 20px;">
                            <!-- Report Header for each patient -->
                            <div class="row">
                                <div class="col-xs-6">
                                    <!-- You can place your company logo here -->
                                    <!-- <img t-if="o.company_id.logo" t-att-src="image_data_uri(o.company_id.logo)" style="max-height: 45px;" alt="Logo"/> -->
                                    <h3>Patient Card</h3>
                                </div>
                                <div class="col-xs-6 text-right">
                                    <h4 class="mt0">
                                        <span t-field="o.name"/>
                                    </h4>
                                    <strong>Reference:</strong>
                                    <span t-field="o.ref"/>
                                </div>
                            </div>

                            <div class="row mt32">
                                <!-- Patient Image -->
                                <div class="col-xs-3">
                                    <div style="border: 1px solid #ddd; padding: 4px; border-radius: 8px; background-color: #f9f9f9; width: 120px; height: 150px; text-align: center;">
                                        <img t-if="o.image" t-att-src="image_data_uri(o.image)"
                                             style="width: 100%; height: 100%; object-fit: cover; border-radius: 4px;"
                                             alt="Patient Image"/>
                                        <div t-if="not o.image" class="text-center text-muted" style="padding: 20px;">
                                            No Image
                                        </div>
                                    </div>
                                </div>

                                <!-- Main Patient Details -->
                                <div class="col-xs-9">
                                    <table class="table table-condensed" style="border: none;">
                                        <tr>
                                            <td style="width: 25%; border: none;">
                                                <strong>Name</strong>
                                            </td>
                                            <td style="border: none;">:
                                                <span t-field="o.name"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="border: none;">
                                                <strong>Age</strong>
                                            </td>
                                            <td style="border: none;">:
                                                <span t-field="o.age"/>
                                                Years
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="border: none;">
                                                <strong>Date of Birth</strong>
                                            </td>
                                            <td style="border: none;">:
                                                <span t-field="o.date_of_birth"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="border: none;">
                                                <strong>Gender</strong>
                                            </td>
                                            <td style="border: none;">:
                                                <span t-field="o.gender"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="border: none;">
                                                <strong>Total Appointments</strong>
                                            </td>
                                            <td style="border: none;">:
                                                <span t-field="o.appointment_count"/>
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                            </div>

                            <hr/>

                            <!-- Two-column layout for additional information -->
                            <div class="row">
                                <!-- Left Column: Other Information -->
                                <div class="col-xs-6">
                                    <h4>Other Information</h4>
                                    <table class="table table-condensed" style="border: none;">
                                        <!-- Marital Status: Always shown -->
                                        <tr>
                                            <td style="width: 40%; border: none;">
                                                <strong>Marital Status</strong>
                                            </td>
                                            <td style="border: none;">:
                                                <span t-field="o.marital_status"/>
                                            </td>
                                        </tr>
                                        <!-- Partner Name: Shown only if married -->
                                        <tr t-if="o.marital_status == 'married'">
                                            <td style="border: none;">
                                                <strong>Partner's Name</strong>
                                            </td>
                                            <td style="border: none;">:
                                                <span t-field="o.partner_name"/>
                                            </td>
                                        </tr>
                                        <!-- Parent Name: Shown only if age is less than 15 -->
                                        <tr t-if="o.age &lt; 15">
                                            <td style="border: none;">
                                                <strong>Parent's Name</strong>
                                            </td>
                                            <td style="border: none;">:
                                                <span t-field="o.parent"/>
                                            </td>
                                        </tr>
                                    </table>
                                </div>

                                <!-- Right Column: Contact Information -->
                                <div class="col-xs-6">
                                    <h4>Contact Information</h4>
                                    <table class="table table-condensed" style="border: none;">
                                        <tr>
                                            <td style="width: 30%; border: none;">
                                                <strong>Phone</strong>
                                            </td>
                                            <td style="border: none;">:
                                                <span t-field="o.phone"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="border: none;">
                                                <strong>Email</strong>
                                            </td>
                                            <td style="border: none;">:
                                                <span t-field="o.email"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="border: none;">
                                                <strong>Website</strong>
                                            </td>
                                            <td style="border: none;">:
                                                <span t-field="o.website"/>
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                            </div>

                            <!-- Patient Tags -->
                            <div class="row mt16" t-if="o.tag_ids">
                                <div class="col-xs-12">
                                    <h4>Tags</h4>
                                    <p>
                                        <t t-foreach="o.tag_ids" t-as="tag">
                                            <span class="badge"
                                                  t-attf-style="background-color: #{tag.color}; color: #FFFFFF; margin: 2px;">
                                                <i class="fa fa-tag"/>
                                                <span t-field="tag.name"/>
                                            </span>
                                        </t>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </t>
                    <t t-set="footer">
                        <div class="text-center">
                            Page
                            <span class="page"/>
                            of
                            <span class="topage"/>
                        </div>
                    </t>
                </div>
            </t>
        </t>
    </template>
</odoo>
